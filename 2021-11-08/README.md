# 서버란 무엇인가?

Node.js로 서버 애플리케이션을 구축할 수 있다.
서버는 네트워크를 통해서 클라이언트에 데이터, 서비스를 제공하는 컴퓨터 프로그램을 의미한다.

즉, 서버는 모바일, 웹, 윈도우 등에서 응답을 보내는 프로그램이다.
HTML을 어디서 받아올까?

1. 서버에 주소를 입력(요청)
2. 브라우저는 입력받은 주소에 해당하는 컴퓨터의 위치를 파악한다.
3. 서버에서는 클라이언트를 빌드하기 위한 HTML,CSS,JS,이미지 등을 보내준다.
4. 사용자의 브라우저에 정상적으로 화면이 뜬다.

# 왜 굳이 Node로 서버를 만드는 걸까?

노드는 자바스크립트의 런타임이다.
런타임이라는 것은 특정 언어로 만든 프로그램들을 실행할 수 있는 환경을 뜻한다,
`노드 === JS실행기`

크롬의 V8엔진 기반으로 만들어진 Node.js는 굉장히 빠른 속도로 데이터를 처리하는 장점이 있어서 많은 개발자들이 서버를 만들때 Node.js 런타임을 이용해서 만든다.

Node.js의 구성요소
![image](https://thebook.io/img/080229/027_1.jpg)

libuv 라이브러리는 노드의 특성인 이벤트 기반, 논 블로킹 I/O 모델을 구현하고 있다.

# 이벤트 기반(event-driven)?

이벤트가 발생할 때 미리 저장해둔 작업을 수행하는 방식을 의미한다.
`ex) 클릭 이벤트, 서버 데이터 요청`

이벤트 기반 시스템에서는 특정 이벤트가 발생할 때 무엇을 할지 등록을 해놔야한다.

> 이벤트 리스너(event listener)에 콜백(callback) 함수를 등록

`ex) 버튼을 클릭 -> Event Listener에 전달된 Callback함수 실행`

이때 이벤트 루프라는 개념이 등장하게 되는데, 여러 이벤트가 동시에 실행됐을때, 어떤 순서로 콜백을 실행할지 이벤트루프가 정해준다.

# setTimeout !== JavaScript Function

그 이유는 setTimeout은 백그라운드이기 때문이다.
백그라운드라는 공간에서 setTimeout, 이벤트 리스너같은 함수들이 대기하고, 자바스크립트가 아닌 다른 언어로 만든 기능으로 봐도 부방하다.

JS의 실행 과정을 잘 나타내는 그림
![image](https://thebook.io/img/080229/030.jpg)

태스크 큐의 콜백이 있는 동안, 뒤에있는 콜백들은 잠시 밀려나기 때문에 setTimeout의 시간이 정확하지 않는 이유다.

# 논 블로킹 I/O

이벤트루프를 잘 이해하면 오래 걸리는 작업들을 효율적으로 처리할 수 있다. 작업에는 동시에 실행할 수 있는 작업과 동시에 실행할 수 없는 작업이 있다.

기본적으로 JS는 싱글쓰레드언어이기 때문에 동시에 실행될 수 없다. 하지만 I/O같은 작업은 동시에 실행될 수 있다.

논 블로킹이란, 작업을 완료할 때까지 기다리지 않고 다른 작업을 수행하는 것이고, 블로킹은 이전 작업이 다 끝나야만 실행하는 것이다.

Node가 I/O작업을 백그라운드에 넘기기 때문에 동시에 처리할 수 있는것이다.

# 블로킹 코드 작성해보기

```js
function longTask() {
  console.log("작업 끝");
}

console.log("시작");
longTask();
console.log("끝");
```

```
결과 >

시작
작업 끝
다음 작업
```

# 논 블로킹 코드 작성해보기

```js
function longTask() {
  console.log("작업 끝");
}

console.log("시작");
setTimeout(longTask, 0);
console.log("끝");
```

```
결과 >

시작
다음 작업
작업 끝
```

setTimeout이라는 기능을 통해 백그라운드에 위임했으므로 다음 작업을 진행하고 longTask를 진행하는 코드를 작성할 수 있다.

이벤트 드리븐을 잘 이애한다면 이해가 되는 코드다.

# 무조건 논 블로킹 코드가 좋은걸까?

아무리 논 블로킹 방식으로 코드를 작성하더라도 우리가 작성한 코드는 전체 소요 시간이 짧아지지는 않는다.

우리가 작성한 코드는 동시에 실행되지 않기때문이다.
그런데 왜 쓰는걸까?

오래 걸리는 작업을 하는 경우에는 실행 순서를 바꿔주는 작업을 통해서 간단한 작업들이 밀려나는 현상을 방지할 수 있다.

**논 블로킹 !== 동시 실행**
동시 실행은 논 블로킹과 같은 개념이 아니다.
동시성은 동시 처리가 가능한 작업을 논 블로킹 처리해야 얻을 수 있다.
